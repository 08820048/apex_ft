# ApexBlog 前台接口文档

## 基本信息

- **基础URL**: `http://localhost:8888/api`
- **API版本**: v1.0
- **数据格式**: JSON
- **字符编码**: UTF-8
- **认证方式**: 大部分接口无需认证，少数接口需要JWT Bearer Token

## 通用响应格式

所有接口都使用统一的响应格式：

```json
{
  "code": 200,
  "message": "操作成功",
  "data": {},
  "timestamp": 1691740800000
}
```

### 响应状态码

| 状态码 | 说明 |
|--------|------|
| 200 | 请求成功 |
| 400 | 请求参数错误 |
| 401 | 未授权，需要登录 |
| 404 | 资源不存在 |
| 500 | 服务器内部错误 |

## 分页响应格式

分页接口的 `data` 字段格式：

```json
{
  "content": [],
  "page": 0,
  "size": 10,
  "totalElements": 100,
  "totalPages": 10,
  "first": true,
  "last": false,
  "hasNext": true,
  "hasPrevious": false
}
```

## 文章接口

### 获取文章列表

**接口**: `GET /articles`

*请求参数**:
- `page` (int, 可选): 页码，从0开始，默认0
- `size` (int, 可选): 每页大小，默认10

**响应数据**: 分页的文章摘要列表

**文章摘要对象**:
```json
{
  "id": 1,
  "title": "文章标题",
  "summary": "文章摘要",
  "coverImage": "http://example.com/cover.jpg",
  "category": {
    "id": 1,
    "name": "技术分享",
    "description": "技术相关文章",
    "sortOrder": 1,
    "createdAt": "2024-01-01T00:00:00",
    "updatedAt": "2024-01-01T00:00:00"
  },
  "authorName": "xuyi",
  "status": "PUBLISHED",
  "isTop": false,
  "viewCount": 100,


  "publishedAt": "2024-01-01T00:00:00",
  "createdAt": "2024-01-01T00:00:00",
  "updatedAt": "2024-01-01T00:00:00",
  "tags": [
    {
      "id": 1,
      "name": "Java",
      "color": "#007396",
      "createdAt": "2024-01-01T00:00:00"
    }
  ]
}
```

### 获取文章详情

**接口**: `GET /articles/{id}`

**路径参数**:
- `id` (long): 文章ID

**响应数据**: 完整的文章对象（包含content字段）

### 根据分类获取文章

**接口**: `GET /articles/category/{categoryId}`

**路径参数**:
- `categoryId` (long): 分类ID

**请求参数**:
- `page` (int, 可选): 页码，默认0
- `size` (int, 可选): 每页大小，默认10

### 根据标签获取文章

**接口**: `GET /articles/tag/{tagId}`

**路径参数**:
- `tagId` (long): 标签ID

**请求参数**:
- `page` (int, 可选): 页码，默认0
- `size` (int, 可选): 每页大小，默认10

### 搜索文章

**接口**: `GET /articles/search`

**请求参数**:
- `keyword` (string, 必需): 搜索关键词
- `page` (int, 可选): 页码，默认0
- `size` (int, 可选): 每页大小，默认10

### 获取置顶文章

**接口**: `GET /articles/top`

**响应数据**: 置顶文章摘要列表



## 分类接口

### 获取所有分类

**接口**: `GET /categories`

**响应数据**: 分类列表

**分类对象**:
```json
{
  "id": 1,
  "name": "技术分享",
  "description": "技术相关文章",
  "sortOrder": 1,
  "createdAt": "2024-01-01T00:00:00",
  "updatedAt": "2024-01-01T00:00:00"
}
```

### 获取分类详情

**接口**: `GET /categories/{id}`

**路径参数**:
- `id` (long): 分类ID

## 标签接口

### 获取所有标签

**接口**: `GET /tags`

**响应数据**: 标签列表

**标签对象**:
```json
{
  "id": 1,
  "name": "Java",
  "color": "#007396",
  "createdAt": "2024-01-01T00:00:00"
}
```

### 获取热门标签

**接口**: `GET /tags/popular`

**响应数据**: 热门标签列表

## 作品集接口

### 获取所有作品集

**接口**: `GET /portfolios`

**响应数据**: 作品集列表

**作品集对象**:
```json
{
  "id": 1,
  "name": "项目名称",
  "description": "项目描述",
  "url": "https://github.com/user/project",
  "coverImage": "http://example.com/cover.jpg",
  "technologies": "Java, Spring Boot, Vue.js",
  "sortOrder": 1,
  "isFeatured": true,
  "createdAt": "2024-01-01T00:00:00",
  "updatedAt": "2024-01-01T00:00:00"
}
```

### 获取精选作品集

**接口**: `GET /portfolios/featured`

**响应数据**: 精选作品集列表

## 友链接口

### 获取友链列表

**接口**: `GET /friend-links`

**响应数据**: 友链列表

**友链对象**:
```json
{
  "id": 1,
  "name": "友站名称",
  "url": "https://example.com",
  "avatar": "http://example.com/avatar.jpg",
  "description": "友站描述",
  "sortOrder": 1,
  "isActive": true,
  "createdAt": "2024-01-01T00:00:00",
  "updatedAt": "2024-01-01T00:00:00"
}
```

## 邮箱订阅接口

### 订阅邮箱

**接口**: `POST /email-subscribers/subscribe`

**请求参数**:
```json
{
  "email": "user@example.com"
}
```

### 取消订阅

**接口**: `GET /email-subscribers/unsubscribe`

**请求参数**:
- `token` (string): 取消订阅token

### 根据邮箱取消订阅

**接口**: `DELETE /email-subscribers/unsubscribe`

**请求参数**:
- `email` (string): 邮箱地址

### 检查订阅状态

**接口**: `GET /email-subscribers/check`

**请求参数**:
- `email` (string): 邮箱地址

**响应数据**: boolean值

### 获取订阅者数量

**接口**: `GET /email-subscribers/count`

**响应数据**: 订阅者数量

## RSS订阅接口

### RSS订阅源

**接口**: `GET /rss/feed.xml`

**响应格式**: XML

### Atom订阅源

**接口**: `GET /rss/atom.xml`

**响应格式**: XML

### 分类RSS订阅源

**接口**: `GET /rss/category/{categoryId}/feed.xml`

**路径参数**:
- `categoryId` (long): 分类ID

**响应格式**: XML

## 搜索接口

### 搜索文章

**接口**: `GET /search/articles`

**请求参数**:
- `keyword` (string, 必需): 搜索关键词
- `page` (int, 可选): 页码，默认0
- `size` (int, 可选): 每页大小，默认10

**响应数据**: 搜索结果分页列表

## 说明

**注意**: 前台博客系统不提供用户注册和登录功能，所有内容均为只读访问。用户认证功能仅用于管理后台。

## 错误处理

### 常见错误响应

**参数验证错误** (400):
```json
{
  "code": 400,
  "message": "参数验证失败",
  "data": {
    "field": "email",
    "message": "邮箱格式不正确"
  },
  "timestamp": 1691740800000
}
```

**资源不存在** (404):
```json
{
  "code": 404,
  "message": "文章不存在",
  "data": null,
  "timestamp": 1691740800000
}
```

## 前端使用示例

### JavaScript Fetch

```javascript
// 获取文章列表
const getArticles = async (page = 0, size = 10) => {
  try {
    const response = await fetch(`http://localhost:8888/api/articles?page=${page}&size=${size}`);
    const data = await response.json();
    
    if (data.code === 200) {
      return data.data;
    } else {
      throw new Error(data.message);
    }
  } catch (error) {
    console.error('获取文章列表失败:', error);
    throw error;
  }
};

// 获取文章详情
const getArticle = async (id) => {
  try {
    const response = await fetch(`http://localhost:8888/api/articles/${id}`);
    const data = await response.json();
    
    if (data.code === 200) {
      return data.data;
    } else {
      throw new Error(data.message);
    }
  } catch (error) {
    console.error('获取文章详情失败:', error);
    throw error;
  }
};

// 搜索文章
const searchArticles = async (keyword, page = 0, size = 10) => {
  try {
    const response = await fetch(
      `http://localhost:8888/api/articles/search?keyword=${encodeURIComponent(keyword)}&page=${page}&size=${size}`
    );
    const data = await response.json();
    
    if (data.code === 200) {
      return data.data;
    } else {
      throw new Error(data.message);
    }
  } catch (error) {
    console.error('搜索文章失败:', error);
    throw error;
  }
};

// 邮箱订阅
const subscribeEmail = async (email) => {
  try {
    const response = await fetch('http://localhost:8888/api/email-subscribers/subscribe', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify({ email })
    });
    const data = await response.json();
    
    if (data.code === 200) {
      return data.data;
    } else {
      throw new Error(data.message);
    }
  } catch (error) {
    console.error('邮箱订阅失败:', error);
    throw error;
  }
};
```

### Vue 3 Composition API

```javascript
// composables/useBlog.js
import { ref, reactive } from 'vue'

export function useBlog() {
  const articles = ref([])
  const categories = ref([])
  const tags = ref([])
  const loading = ref(false)
  
  const pagination = reactive({
    page: 0,
    size: 10,
    total: 0,
    totalPages: 0
  })
  
  // 获取文章列表
  const fetchArticles = async (page = 0, size = 10) => {
    loading.value = true
    try {
      const response = await fetch(`/api/articles?page=${page}&size=${size}`)
      const data = await response.json()
      
      if (data.code === 200) {
        articles.value = data.data.content
        pagination.page = data.data.page
        pagination.size = data.data.size
        pagination.total = data.data.totalElements
        pagination.totalPages = data.data.totalPages
      }
    } catch (error) {
      console.error('获取文章失败:', error)
    } finally {
      loading.value = false
    }
  }
  
  // 获取分类列表
  const fetchCategories = async () => {
    try {
      const response = await fetch('/api/categories')
      const data = await response.json()
      
      if (data.code === 200) {
        categories.value = data.data
      }
    } catch (error) {
      console.error('获取分类失败:', error)
    }
  }
  
  // 获取标签列表
  const fetchTags = async () => {
    try {
      const response = await fetch('/api/tags')
      const data = await response.json()
      
      if (data.code === 200) {
        tags.value = data.data
      }
    } catch (error) {
      console.error('获取标签失败:', error)
    }
  }
  
  return {
    articles,
    categories,
    tags,
    loading,
    pagination,
    fetchArticles,
    fetchCategories,
    fetchTags
  }
}
```

### React Hooks

```javascript
// hooks/useBlog.js
import { useState, useEffect, useCallback } from 'react'

export const useBlog = () => {
  const [articles, setArticles] = useState([])
  const [categories, setCategories] = useState([])
  const [tags, setTags] = useState([])
  const [loading, setLoading] = useState(false)
  const [pagination, setPagination] = useState({
    page: 0,
    size: 10,
    total: 0,
    totalPages: 0
  })
  
  // 获取文章列表
  const fetchArticles = useCallback(async (page = 0, size = 10) => {
    setLoading(true)
    try {
      const response = await fetch(`/api/articles?page=${page}&size=${size}`)
      const data = await response.json()
      
      if (data.code === 200) {
        setArticles(data.data.content)
        setPagination({
          page: data.data.page,
          size: data.data.size,
          total: data.data.totalElements,
          totalPages: data.data.totalPages
        })
      }
    } catch (error) {
      console.error('获取文章失败:', error)
    } finally {
      setLoading(false)
    }
  }, [])
  
  // 获取分类列表
  const fetchCategories = useCallback(async () => {
    try {
      const response = await fetch('/api/categories')
      const data = await response.json()
      
      if (data.code === 200) {
        setCategories(data.data)
      }
    } catch (error) {
      console.error('获取分类失败:', error)
    }
  }, [])
  
  // 获取标签列表
  const fetchTags = useCallback(async () => {
    try {
      const response = await fetch('/api/tags')
      const data = await response.json()
      
      if (data.code === 200) {
        setTags(data.data)
      }
    } catch (error) {
      console.error('获取标签失败:', error)
    }
  }, [])
  
  return {
    articles,
    categories,
    tags,
    loading,
    pagination,
    fetchArticles,
    fetchCategories,
    fetchTags
  }
}
```

## 注意事项

1. **跨域配置**: 开发环境已配置CORS，生产环境需要配置相应的域名
2. **分页参数**: 页码从0开始，不是从1开始
3. **搜索关键词**: 需要进行URL编码
4. **RSS缓存**: RSS接口有1小时的缓存
5. **邮箱验证**: 订阅邮箱需要有效的邮箱格式
6. **文章状态**: 前台只能获取已发布(PUBLISHED)状态的文章

## 在线文档

完整的API文档可以通过以下方式查看：

- **Swagger UI**: http://localhost:8888/api/swagger-ui.html
- **OpenAPI JSON**: http://localhost:8888/api/api-docs

建议在开发过程中结合Swagger UI进行接口测试和调试。
