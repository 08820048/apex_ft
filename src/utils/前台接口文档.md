# ApexBlog å‰å°æ¥å£æ–‡æ¡£

## åŸºæœ¬ä¿¡æ¯

- **åŸºç¡€ URL**: `http://localhost:8888/api`
- **API ç‰ˆæœ¬**: v1.0
- **æ•°æ®æ ¼å¼**: JSON
- **å­—ç¬¦ç¼–ç **: UTF-8
- **è®¤è¯æ–¹å¼**: å¤§éƒ¨åˆ†æ¥å£æ— éœ€è®¤è¯ï¼Œå°‘æ•°æ¥å£éœ€è¦ JWT Bearer Token

## é€šç”¨å“åº”æ ¼å¼

æ‰€æœ‰æ¥å£éƒ½ä½¿ç”¨ç»Ÿä¸€çš„å“åº”æ ¼å¼ï¼š

```json
{
  "code": 200,
  "message": "æ“ä½œæˆåŠŸ",
  "data": {},
  "timestamp": 1691740800000,
  "queryStats": null
}
```

### æŸ¥è¯¢ç»Ÿè®¡åŠŸèƒ½ ğŸ†•

éƒ¨åˆ†æ¥å£æ”¯æŒè¿”å›æ•°æ®åº“æŸ¥è¯¢ç»Ÿè®¡ä¿¡æ¯ï¼Œç”¨äºå±•ç¤ºåå°æŸ¥è¯¢æ€§èƒ½å’Œé€æ˜åº¦ï¼š

**å¯ç”¨æŸ¥è¯¢ç»Ÿè®¡**ï¼šåœ¨è¯·æ±‚å‚æ•°ä¸­æ·»åŠ  `includeStats=true`

**æŸ¥è¯¢ç»Ÿè®¡å¯¹è±¡**ï¼š

```json
{
  "queryStats": {
    "requestId": "REQ_1755005051646_26",
    "requestPath": "/api/articles",
    "requestMethod": "GET",
    "totalQueries": 4,
    "totalExecutionTime": 71,
    "averageExecutionTime": 17.75,
    "slowestQueryTime": 31,
    "queries": [
      {
        "queryIndex": 1,
        "sql": "SELECT DISTINCT a FROM Article a LEFT JOIN FETCH a.tags WHERE a.status = :status ORDER BY a.isTop DESC, a.publishedAt DESC",
        "formattedSql": "SELECT DISTINCT a FROM Article a\nLEFT JOIN FETCH a.tags\nWHERE a.status = :status\nORDER BY a.isTop DESC, a.publishedAt DESC",
        "queryType": "SELECT",
        "executionTime": 31,
        "parameters": [],
        "tables": ["articles", "article_tags", "tags"],
        "isSlowQuery": false,
        "startTime": "2025-08-12T21:24:04.123456",
        "endTime": "2025-08-12T21:24:04.154456",
        "errorMessage": null
      }
    ],
    "timestamp": "2025-08-12T21:24:11.646561",
    "queryTypeStats": {
      "SELECT": 4
    },
    "tableAccessStats": {
      "articles": 2,
      "categories": 2,
      "users": 1,
      "article_tags": 1,
      "tags": 1
    }
  }
}
```

**æŸ¥è¯¢ç»Ÿè®¡å­—æ®µè¯´æ˜**ï¼š

- `requestId`: è¯·æ±‚å”¯ä¸€æ ‡è¯†
- `requestPath`: è¯·æ±‚è·¯å¾„
- `requestMethod`: è¯·æ±‚æ–¹æ³•
- `totalQueries`: æ€»æŸ¥è¯¢æ•°é‡
- `totalExecutionTime`: æ€»æ‰§è¡Œæ—¶é—´ï¼ˆæ¯«ç§’ï¼‰
- `averageExecutionTime`: å¹³å‡æ‰§è¡Œæ—¶é—´ï¼ˆæ¯«ç§’ï¼‰
- `slowestQueryTime`: æœ€æ…¢æŸ¥è¯¢æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰
- `queries`: è¯¦ç»†æŸ¥è¯¢åˆ—è¡¨
- `queryTypeStats`: æŸ¥è¯¢ç±»å‹ç»Ÿè®¡
- `tableAccessStats`: è¡¨è®¿é—®ç»Ÿè®¡

### å“åº”çŠ¶æ€ç 

| çŠ¶æ€ç  | è¯´æ˜             |
| ------ | ---------------- |
| 200    | è¯·æ±‚æˆåŠŸ         |
| 400    | è¯·æ±‚å‚æ•°é”™è¯¯     |
| 401    | æœªæˆæƒï¼Œéœ€è¦ç™»å½• |
| 404    | èµ„æºä¸å­˜åœ¨       |
| 500    | æœåŠ¡å™¨å†…éƒ¨é”™è¯¯   |

## åˆ†é¡µå“åº”æ ¼å¼

åˆ†é¡µæ¥å£çš„ `data` å­—æ®µæ ¼å¼ï¼š

```json
{
  "content": [],
  "page": 0,
  "size": 10,
  "totalElements": 100,
  "totalPages": 10,
  "first": true,
  "last": false,
  "hasNext": true,
  "hasPrevious": false
}
```

## æ–‡ç« æ¥å£

### è·å–æ–‡ç« åˆ—è¡¨

**æ¥å£**: `GET /articles`

**è¯·æ±‚å‚æ•°**:

- `page` (int, å¯é€‰): é¡µç ï¼Œä» 0 å¼€å§‹ï¼Œé»˜è®¤ 0
- `size` (int, å¯é€‰): æ¯é¡µå¤§å°ï¼Œé»˜è®¤ 10
- `includeStats` (boolean, å¯é€‰): æ˜¯å¦åŒ…å«æŸ¥è¯¢ç»Ÿè®¡ä¿¡æ¯ï¼Œé»˜è®¤ false ğŸ†•

**å“åº”æ•°æ®**: åˆ†é¡µçš„æ–‡ç« æ‘˜è¦åˆ—è¡¨

**ç¤ºä¾‹è¯·æ±‚**:

```
GET /articles?page=0&size=10&includeStats=true
```

**æ–‡ç« æ‘˜è¦å¯¹è±¡**:

```json
{
  "id": 1,
  "title": "æ–‡ç« æ ‡é¢˜",
  "summary": "æ–‡ç« æ‘˜è¦",
  "coverImage": "http://example.com/cover.jpg",
  "category": {
    "id": 1,
    "name": "æŠ€æœ¯åˆ†äº«",
    "description": "æŠ€æœ¯ç›¸å…³æ–‡ç« ",
    "sortOrder": 1,
    "createdAt": "2024-01-01T00:00:00",
    "updatedAt": "2024-01-01T00:00:00"
  },
  "authorName": "æ…•äºˆ",
  "status": "PUBLISHED",
  "isTop": false,
  "viewCount": 100,

  "publishedAt": "2024-01-01T00:00:00",
  "createdAt": "2024-01-01T00:00:00",
  "updatedAt": "2024-01-01T00:00:00",
  "tags": [
    {
      "id": 1,
      "name": "Java",
      "color": "#007396",
      "createdAt": "2024-01-01T00:00:00"
    }
  ]
}
```

### è·å–æ–‡ç« è¯¦æƒ…

**æ¥å£**: `GET /articles/{id}`

**è·¯å¾„å‚æ•°**:

- `id` (long): æ–‡ç«  ID

**å“åº”æ•°æ®**: å®Œæ•´çš„æ–‡ç« å¯¹è±¡ï¼ˆåŒ…å« content å­—æ®µï¼‰

### æ ¹æ®åˆ†ç±»è·å–æ–‡ç« 

**æ¥å£**: `GET /articles/category/{categoryId}`

**è·¯å¾„å‚æ•°**:

- `categoryId` (long): åˆ†ç±» ID

**è¯·æ±‚å‚æ•°**:

- `page` (int, å¯é€‰): é¡µç ï¼Œé»˜è®¤ 0
- `size` (int, å¯é€‰): æ¯é¡µå¤§å°ï¼Œé»˜è®¤ 10

### æ ¹æ®æ ‡ç­¾è·å–æ–‡ç« 

**æ¥å£**: `GET /articles/tag/{tagId}`

**è·¯å¾„å‚æ•°**:

- `tagId` (long): æ ‡ç­¾ ID

**è¯·æ±‚å‚æ•°**:

- `page` (int, å¯é€‰): é¡µç ï¼Œé»˜è®¤ 0
- `size` (int, å¯é€‰): æ¯é¡µå¤§å°ï¼Œé»˜è®¤ 10

### æœç´¢æ–‡ç« 

**æ¥å£**: `GET /articles/search`

**è¯·æ±‚å‚æ•°**:

- `keyword` (string, å¿…éœ€): æœç´¢å…³é”®è¯
- `page` (int, å¯é€‰): é¡µç ï¼Œé»˜è®¤ 0
- `size` (int, å¯é€‰): æ¯é¡µå¤§å°ï¼Œé»˜è®¤ 10

### è·å–ç½®é¡¶æ–‡ç« 

**æ¥å£**: `GET /articles/top`

**å“åº”æ•°æ®**: ç½®é¡¶æ–‡ç« æ‘˜è¦åˆ—è¡¨

## åˆ†ç±»æ¥å£

### è·å–æ‰€æœ‰åˆ†ç±»

**æ¥å£**: `GET /categories`

**å“åº”æ•°æ®**: åˆ†ç±»åˆ—è¡¨

**åˆ†ç±»å¯¹è±¡**:

```json
{
  "id": 1,
  "name": "æŠ€æœ¯åˆ†äº«",
  "description": "æŠ€æœ¯ç›¸å…³æ–‡ç« ",
  "sortOrder": 1,
  "createdAt": "2024-01-01T00:00:00",
  "updatedAt": "2024-01-01T00:00:00"
}
```

### è·å–åˆ†ç±»è¯¦æƒ…

**æ¥å£**: `GET /categories/{id}`

**è·¯å¾„å‚æ•°**:

- `id` (long): åˆ†ç±» ID

## æ ‡ç­¾æ¥å£

### è·å–æ‰€æœ‰æ ‡ç­¾

**æ¥å£**: `GET /tags`

**å“åº”æ•°æ®**: æ ‡ç­¾åˆ—è¡¨

**æ ‡ç­¾å¯¹è±¡**:

```json
{
  "id": 1,
  "name": "Java",
  "color": "#007396",
  "createdAt": "2024-01-01T00:00:00"
}
```

### è·å–çƒ­é—¨æ ‡ç­¾

**æ¥å£**: `GET /tags/popular`

**å“åº”æ•°æ®**: çƒ­é—¨æ ‡ç­¾åˆ—è¡¨

## ä½œå“é›†æ¥å£

### è·å–æ‰€æœ‰ä½œå“é›†

**æ¥å£**: `GET /portfolios`

**å“åº”æ•°æ®**: ä½œå“é›†åˆ—è¡¨

**ä½œå“é›†å¯¹è±¡**:

```json
{
  "id": 1,
  "name": "é¡¹ç›®åç§°",
  "description": "é¡¹ç›®æè¿°",
  "url": "https://github.com/user/project",
  "coverImage": "http://example.com/cover.jpg",
  "technologies": "Java, Spring Boot, Vue.js",
  "sortOrder": 1,
  "isFeatured": true,
  "createdAt": "2024-01-01T00:00:00",
  "updatedAt": "2024-01-01T00:00:00"
}
```

### è·å–ç²¾é€‰ä½œå“é›†

**æ¥å£**: `GET /portfolios/featured`

**å“åº”æ•°æ®**: ç²¾é€‰ä½œå“é›†åˆ—è¡¨

## å‹é“¾æ¥å£

### è·å–å‹é“¾åˆ—è¡¨

**æ¥å£**: `GET /friend-links`

**å“åº”æ•°æ®**: å‹é“¾åˆ—è¡¨

**å‹é“¾å¯¹è±¡**:

```json
{
  "id": 1,
  "name": "å‹ç«™åç§°",
  "url": "https://example.com",
  "avatar": "http://example.com/avatar.jpg",
  "description": "å‹ç«™æè¿°",
  "sortOrder": 1,
  "isActive": true,
  "createdAt": "2024-01-01T00:00:00",
  "updatedAt": "2024-01-01T00:00:00"
}
```

## é‚®ç®±è®¢é˜…æ¥å£

### è®¢é˜…é‚®ç®±

**æ¥å£**: `POST /email-subscribers/subscribe`

**è¯·æ±‚å‚æ•°**:

```json
{
  "email": "user@example.com"
}
```

### å–æ¶ˆè®¢é˜…

**æ¥å£**: `GET /email-subscribers/unsubscribe`

**è¯·æ±‚å‚æ•°**:

- `token` (string): å–æ¶ˆè®¢é˜… token

### æ ¹æ®é‚®ç®±å–æ¶ˆè®¢é˜…

**æ¥å£**: `DELETE /email-subscribers/unsubscribe`

**è¯·æ±‚å‚æ•°**:

- `email` (string): é‚®ç®±åœ°å€

### æ£€æŸ¥è®¢é˜…çŠ¶æ€

**æ¥å£**: `GET /email-subscribers/check`

**è¯·æ±‚å‚æ•°**:

- `email` (string): é‚®ç®±åœ°å€

**å“åº”æ•°æ®**: boolean å€¼

### è·å–è®¢é˜…è€…æ•°é‡

**æ¥å£**: `GET /email-subscribers/count`

**å“åº”æ•°æ®**: è®¢é˜…è€…æ•°é‡

## RSS è®¢é˜…æ¥å£

### RSS è®¢é˜…æº

**æ¥å£**: `GET /rss/feed.xml`

**å“åº”æ ¼å¼**: XML

### Atom è®¢é˜…æº

**æ¥å£**: `GET /rss/atom.xml`

**å“åº”æ ¼å¼**: XML

### åˆ†ç±» RSS è®¢é˜…æº

**æ¥å£**: `GET /rss/category/{categoryId}/feed.xml`

**è·¯å¾„å‚æ•°**:

- `categoryId` (long): åˆ†ç±» ID

**å“åº”æ ¼å¼**: XML

## æœç´¢æ¥å£

### æœç´¢æ–‡ç« 

**æ¥å£**: `GET /search/articles`

**è¯·æ±‚å‚æ•°**:

- `keyword` (string, å¿…éœ€): æœç´¢å…³é”®è¯
- `page` (int, å¯é€‰): é¡µç ï¼Œé»˜è®¤ 0
- `size` (int, å¯é€‰): æ¯é¡µå¤§å°ï¼Œé»˜è®¤ 10

**å“åº”æ•°æ®**: æœç´¢ç»“æœåˆ†é¡µåˆ—è¡¨

## ç»¼åˆç»Ÿè®¡æ¥å£ ğŸ†•

### è·å–åšå®¢ç»¼åˆç»Ÿè®¡ä¿¡æ¯

**æ¥å£**: `GET /stats/overview`

**æè¿°**: è·å–åšå®¢çš„ç»¼åˆç»Ÿè®¡ä¿¡æ¯ï¼ŒåŒ…æ‹¬æ–‡ç« æ•°é‡ã€è®¿é—®é‡ã€æ ‡ç­¾æ•°é‡ã€åˆ†ç±»æ•°é‡ç­‰

**å“åº”æ•°æ®**:

```json
{
  "code": 200,
  "message": "æ“ä½œæˆåŠŸ",
  "data": {
    "articleCount": 25,
    "visitCount": 12580,
    "tagCount": 15,
    "categoryCount": 8,
    "todayVisitCount": 156,
    "subscriberCount": 89,
    "friendLinkCount": 12,
    "portfolioCount": 6
  },
  "timestamp": 1691740800000
}
```

**ç»Ÿè®¡å­—æ®µè¯´æ˜**:

- `articleCount`: æ–‡ç« æ€»æ•°
- `visitCount`: æ€»è®¿é—®é‡
- `tagCount`: æ ‡ç­¾æ•°é‡
- `categoryCount`: åˆ†ç±»æ•°é‡
- `todayVisitCount`: ä»Šæ—¥è®¿é—®é‡
- `subscriberCount`: è®¢é˜…è€…æ•°é‡
- `friendLinkCount`: å‹é“¾æ•°é‡
- `portfolioCount`: ä½œå“é›†æ•°é‡

## æŸ¥è¯¢ç»Ÿè®¡æ¥å£ ğŸ†•

### è·å–å…¨å±€æŸ¥è¯¢ç»Ÿè®¡

**æ¥å£**: `GET /query-stats/global`

**å“åº”æ•°æ®**: æœ€è¿‘çš„æŸ¥è¯¢ç»Ÿè®¡åˆ—è¡¨

### è·å–æŸ¥è¯¢ç»Ÿè®¡æ‘˜è¦

**æ¥å£**: `GET /query-stats/summary`

**å“åº”æ•°æ®**: æŸ¥è¯¢ç»Ÿè®¡æ‘˜è¦ä¿¡æ¯

**æ‘˜è¦å¯¹è±¡**:

```json
{
  "totalRequests": 25,
  "totalQueries": 100,
  "averageQueriesPerRequest": 4.0,
  "totalExecutionTime": 1250,
  "averageExecutionTime": 12.5,
  "slowestQuery": 85,
  "queryTypeDistribution": {
    "SELECT": 95,
    "INSERT": 3,
    "UPDATE": 2
  },
  "tableAccessDistribution": {
    "articles": 45,
    "categories": 20,
    "users": 15,
    "tags": 10,
    "article_tags": 10
  },
  "recentRequests": []
}
```

### è·å–æŒ‡å®šè¯·æ±‚çš„æŸ¥è¯¢ç»Ÿè®¡

**æ¥å£**: `GET /query-stats/request/{requestId}`

**è·¯å¾„å‚æ•°**:

- `requestId` (string): è¯·æ±‚ ID

**å“åº”æ•°æ®**: æŒ‡å®šè¯·æ±‚çš„è¯¦ç»†æŸ¥è¯¢ç»Ÿè®¡

### æŸ¥è¯¢ç»Ÿè®¡æœåŠ¡å¥åº·æ£€æŸ¥

**æ¥å£**: `GET /query-stats/health`

**å“åº”æ•°æ®**: æœåŠ¡å¥åº·çŠ¶æ€

### æ¸…ç†æŸ¥è¯¢ç»Ÿè®¡æ•°æ®

**æ¥å£**: `DELETE /query-stats/clear`

**å“åº”æ•°æ®**: æ¸…ç†ç»“æœ

## è¯´æ˜

**æ³¨æ„**: å‰å°åšå®¢ç³»ç»Ÿä¸æä¾›ç”¨æˆ·æ³¨å†Œå’Œç™»å½•åŠŸèƒ½ï¼Œæ‰€æœ‰å†…å®¹å‡ä¸ºåªè¯»è®¿é—®ã€‚ç”¨æˆ·è®¤è¯åŠŸèƒ½ä»…ç”¨äºç®¡ç†åå°ã€‚

## é”™è¯¯å¤„ç†

### å¸¸è§é”™è¯¯å“åº”

**å‚æ•°éªŒè¯é”™è¯¯** (400):

```json
{
  "code": 400,
  "message": "å‚æ•°éªŒè¯å¤±è´¥",
  "data": {
    "field": "email",
    "message": "é‚®ç®±æ ¼å¼ä¸æ­£ç¡®"
  },
  "timestamp": 1691740800000
}
```

**èµ„æºä¸å­˜åœ¨** (404):

```json
{
  "code": 404,
  "message": "æ–‡ç« ä¸å­˜åœ¨",
  "data": null,
  "timestamp": 1691740800000
}
```

## å‰ç«¯ä½¿ç”¨ç¤ºä¾‹

### JavaScript Fetch

```javascript
// è·å–æ–‡ç« åˆ—è¡¨
const getArticles = async (page = 0, size = 10, includeStats = false) => {
  try {
    const url = `http://localhost:8888/api/articles?page=${page}&size=${size}${
      includeStats ? "&includeStats=true" : ""
    }`;
    const response = await fetch(url);
    const data = await response.json();

    if (data.code === 200) {
      // å¦‚æœåŒ…å«æŸ¥è¯¢ç»Ÿè®¡ï¼Œå¯ä»¥åœ¨è¿™é‡Œå¤„ç†
      if (data.queryStats) {
        console.log("æŸ¥è¯¢ç»Ÿè®¡:", data.queryStats);
        console.log(
          `æ‰§è¡Œäº† ${data.queryStats.totalQueries} ä¸ªæŸ¥è¯¢ï¼Œæ€»è€—æ—¶ ${data.queryStats.totalExecutionTime}ms`
        );
      }
      return data.data;
    } else {
      throw new Error(data.message);
    }
  } catch (error) {
    console.error("è·å–æ–‡ç« åˆ—è¡¨å¤±è´¥:", error);
    throw error;
  }
};

// è·å–æŸ¥è¯¢ç»Ÿè®¡æ‘˜è¦
const getQueryStatsSummary = async () => {
  try {
    const response = await fetch(
      "http://localhost:8888/api/query-stats/summary"
    );
    const data = await response.json();

    if (data.code === 200) {
      return data.data;
    } else {
      throw new Error(data.message);
    }
  } catch (error) {
    console.error("è·å–æŸ¥è¯¢ç»Ÿè®¡å¤±è´¥:", error);
    throw error;
  }
};

// è·å–æ–‡ç« è¯¦æƒ…
const getArticle = async (id) => {
  try {
    const response = await fetch(`http://localhost:8888/api/articles/${id}`);
    const data = await response.json();

    if (data.code === 200) {
      return data.data;
    } else {
      throw new Error(data.message);
    }
  } catch (error) {
    console.error("è·å–æ–‡ç« è¯¦æƒ…å¤±è´¥:", error);
    throw error;
  }
};

// æœç´¢æ–‡ç« 
const searchArticles = async (keyword, page = 0, size = 10) => {
  try {
    const response = await fetch(
      `http://localhost:8888/api/articles/search?keyword=${encodeURIComponent(
        keyword
      )}&page=${page}&size=${size}`
    );
    const data = await response.json();

    if (data.code === 200) {
      return data.data;
    } else {
      throw new Error(data.message);
    }
  } catch (error) {
    console.error("æœç´¢æ–‡ç« å¤±è´¥:", error);
    throw error;
  }
};

// é‚®ç®±è®¢é˜…
const subscribeEmail = async (email) => {
  try {
    const response = await fetch(
      "http://localhost:8888/api/email-subscribers/subscribe",
      {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
        },
        body: JSON.stringify({ email }),
      }
    );
    const data = await response.json();

    if (data.code === 200) {
      return data.data;
    } else {
      throw new Error(data.message);
    }
  } catch (error) {
    console.error("é‚®ç®±è®¢é˜…å¤±è´¥:", error);
    throw error;
  }
};
```

### Vue 3 Composition API

```javascript
// composables/useBlog.js
import { ref, reactive } from "vue";

export function useBlog() {
  const articles = ref([]);
  const categories = ref([]);
  const tags = ref([]);
  const loading = ref(false);
  const queryStats = ref(null); // ğŸ†• æŸ¥è¯¢ç»Ÿè®¡

  const pagination = reactive({
    page: 0,
    size: 10,
    total: 0,
    totalPages: 0,
  });

  // è·å–æ–‡ç« åˆ—è¡¨
  const fetchArticles = async (page = 0, size = 10, includeStats = false) => {
    loading.value = true;
    try {
      const url = `/api/articles?page=${page}&size=${size}${
        includeStats ? "&includeStats=true" : ""
      }`;
      const response = await fetch(url);
      const data = await response.json();

      if (data.code === 200) {
        articles.value = data.data.content;
        pagination.page = data.data.page;
        pagination.size = data.data.size;
        pagination.total = data.data.totalElements;
        pagination.totalPages = data.data.totalPages;

        // ğŸ†• ä¿å­˜æŸ¥è¯¢ç»Ÿè®¡ä¿¡æ¯
        queryStats.value = data.queryStats;
      }
    } catch (error) {
      console.error("è·å–æ–‡ç« å¤±è´¥:", error);
    } finally {
      loading.value = false;
    }
  };

  // ğŸ†• è·å–æŸ¥è¯¢ç»Ÿè®¡æ‘˜è¦
  const fetchQueryStatsSummary = async () => {
    try {
      const response = await fetch("/api/query-stats/summary");
      const data = await response.json();

      if (data.code === 200) {
        return data.data;
      }
    } catch (error) {
      console.error("è·å–æŸ¥è¯¢ç»Ÿè®¡å¤±è´¥:", error);
    }
  };

  // è·å–åˆ†ç±»åˆ—è¡¨
  const fetchCategories = async () => {
    try {
      const response = await fetch("/api/categories");
      const data = await response.json();

      if (data.code === 200) {
        categories.value = data.data;
      }
    } catch (error) {
      console.error("è·å–åˆ†ç±»å¤±è´¥:", error);
    }
  };

  // è·å–æ ‡ç­¾åˆ—è¡¨
  const fetchTags = async () => {
    try {
      const response = await fetch("/api/tags");
      const data = await response.json();

      if (data.code === 200) {
        tags.value = data.data;
      }
    } catch (error) {
      console.error("è·å–æ ‡ç­¾å¤±è´¥:", error);
    }
  };

  return {
    articles,
    categories,
    tags,
    loading,
    pagination,
    queryStats, // ğŸ†•
    fetchArticles,
    fetchCategories,
    fetchTags,
    fetchQueryStatsSummary, // ğŸ†•
  };
}
```

## æŸ¥è¯¢ç»Ÿè®¡åŠŸèƒ½å‰ç«¯é›†æˆå»ºè®® ğŸ†•

### 1. å¼€å‘è€…å·¥å…·é¢æ¿

å¯ä»¥åœ¨å‰ç«¯æ·»åŠ ä¸€ä¸ªå¼€å‘è€…å·¥å…·é¢æ¿æ¥å±•ç¤ºæŸ¥è¯¢ç»Ÿè®¡ä¿¡æ¯ï¼š

```javascript
// utils/queryStatsPanel.js
class QueryStatsPanel {
  constructor() {
    this.isVisible = false;
    this.stats = [];
    this.init();
  }

  init() {
    // åˆ›å»ºé¢æ¿DOM
    this.createPanel();

    // ç›‘å¬é”®ç›˜å¿«æ·é”® (Ctrl+Shift+Q)
    document.addEventListener("keydown", (e) => {
      if (e.ctrlKey && e.shiftKey && e.key === "Q") {
        this.toggle();
      }
    });
  }

  createPanel() {
    const panel = document.createElement("div");
    panel.id = "query-stats-panel";
    panel.style.cssText = `
      position: fixed;
      top: 20px;
      right: 20px;
      width: 400px;
      max-height: 600px;
      background: #1a1a1a;
      color: #fff;
      border-radius: 8px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.3);
      z-index: 10000;
      display: none;
      overflow: hidden;
    `;

    panel.innerHTML = `
      <div style="padding: 16px; border-bottom: 1px solid #333;">
        <h3 style="margin: 0; color: #4CAF50;">æ•°æ®åº“æŸ¥è¯¢ç»Ÿè®¡</h3>
        <button onclick="queryStatsPanel.clear()" style="float: right; background: #f44336; color: white; border: none; padding: 4px 8px; border-radius: 4px; cursor: pointer;">æ¸…ç©º</button>
      </div>
      <div id="stats-content" style="padding: 16px; max-height: 500px; overflow-y: auto;"></div>
    `;

    document.body.appendChild(panel);
    this.panel = panel;
  }

  toggle() {
    this.isVisible = !this.isVisible;
    this.panel.style.display = this.isVisible ? "block" : "none";

    if (this.isVisible) {
      this.loadGlobalStats();
    }
  }

  async loadGlobalStats() {
    try {
      const response = await fetch("/api/query-stats/summary");
      const data = await response.json();

      if (data.code === 200) {
        this.renderSummary(data.data);
      }
    } catch (error) {
      console.error("åŠ è½½æŸ¥è¯¢ç»Ÿè®¡å¤±è´¥:", error);
    }
  }

  renderSummary(summary) {
    const content = document.getElementById("stats-content");
    content.innerHTML = `
      <div style="margin-bottom: 16px;">
        <h4 style="color: #2196F3; margin: 0 0 8px 0;">æ€»ä½“ç»Ÿè®¡</h4>
        <p>æ€»è¯·æ±‚æ•°: <span style="color: #4CAF50;">${
          summary.totalRequests
        }</span></p>
        <p>æ€»æŸ¥è¯¢æ•°: <span style="color: #4CAF50;">${
          summary.totalQueries
        }</span></p>
        <p>å¹³å‡æŸ¥è¯¢æ•°/è¯·æ±‚: <span style="color: #4CAF50;">${
          summary.averageQueriesPerRequest
        }</span></p>
        <p>æ€»æ‰§è¡Œæ—¶é—´: <span style="color: #4CAF50;">${
          summary.totalExecutionTime
        }ms</span></p>
        <p>å¹³å‡æ‰§è¡Œæ—¶é—´: <span style="color: #4CAF50;">${
          summary.averageExecutionTime
        }ms</span></p>
        <p>æœ€æ…¢æŸ¥è¯¢: <span style="color: ${
          summary.slowestQuery > 100 ? "#f44336" : "#4CAF50"
        };">${summary.slowestQuery}ms</span></p>
      </div>

      <div style="margin-bottom: 16px;">
        <h4 style="color: #2196F3; margin: 0 0 8px 0;">æŸ¥è¯¢ç±»å‹åˆ†å¸ƒ</h4>
        ${Object.entries(summary.queryTypeDistribution || {})
          .map(
            ([type, count]) =>
              `<p>${type}: <span style="color: #4CAF50;">${count}</span></p>`
          )
          .join("")}
      </div>

      <div>
        <h4 style="color: #2196F3; margin: 0 0 8px 0;">è¡¨è®¿é—®ç»Ÿè®¡</h4>
        ${Object.entries(summary.tableAccessDistribution || {})
          .map(
            ([table, count]) =>
              `<p>${table}: <span style="color: #4CAF50;">${count}</span></p>`
          )
          .join("")}
      </div>
    `;
  }

  clear() {
    fetch("/api/query-stats/clear", { method: "DELETE" }).then(() => {
      this.loadGlobalStats();
    });
  }
}

// å…¨å±€å®ä¾‹
const queryStatsPanel = new QueryStatsPanel();
```

### 2. åœ¨ Vue ç»„ä»¶ä¸­ä½¿ç”¨

```vue
<template>
  <div class="article-list">
    <!-- æ–‡ç« åˆ—è¡¨ -->
    <div v-for="article in articles" :key="article.id" class="article-item">
      <h3>{{ article.title }}</h3>
      <p>{{ article.summary }}</p>
    </div>

    <!-- æŸ¥è¯¢ç»Ÿè®¡ä¿¡æ¯ (å¼€å‘æ¨¡å¼ä¸‹æ˜¾ç¤º) -->
    <div v-if="isDev && queryStats" class="query-stats">
      <h4>ğŸ” æŸ¥è¯¢ç»Ÿè®¡</h4>
      <p>
        æ‰§è¡Œäº† {{ queryStats.totalQueries }} ä¸ªæŸ¥è¯¢ï¼Œæ€»è€—æ—¶
        {{ queryStats.totalExecutionTime }}ms
      </p>
      <details>
        <summary>æŸ¥è¯¢è¯¦æƒ…</summary>
        <div
          v-for="query in queryStats.queries"
          :key="query.queryIndex"
          class="query-item"
        >
          <p>
            <strong>æŸ¥è¯¢ {{ query.queryIndex }}:</strong>
            {{ query.queryType }} ({{ query.executionTime }}ms)
          </p>
          <p>
            <small>æ¶‰åŠè¡¨: {{ query.tables.join(", ") }}</small>
          </p>
        </div>
      </details>
    </div>
  </div>
</template>

<script>
import { useBlog } from "@/composables/useBlog";

export default {
  name: "ArticleList",
  setup() {
    const { articles, queryStats, fetchArticles } = useBlog();

    // å¼€å‘æ¨¡å¼æ£€æµ‹
    const isDev = process.env.NODE_ENV === "development";

    // åœ¨å¼€å‘æ¨¡å¼ä¸‹å¯ç”¨æŸ¥è¯¢ç»Ÿè®¡
    const loadArticles = (page = 0, size = 10) => {
      fetchArticles(page, size, isDev);
    };

    return {
      articles,
      queryStats,
      isDev,
      loadArticles,
    };
  },
};
</script>

<style scoped>
.query-stats {
  margin-top: 20px;
  padding: 16px;
  background: #f5f5f5;
  border-radius: 8px;
  border-left: 4px solid #4caf50;
}

.query-item {
  margin: 8px 0;
  padding: 8px;
  background: white;
  border-radius: 4px;
}
</style>
```

## æ³¨æ„äº‹é¡¹

1. **è·¨åŸŸé…ç½®**: å¼€å‘ç¯å¢ƒå·²é…ç½® CORSï¼Œç”Ÿäº§ç¯å¢ƒéœ€è¦é…ç½®ç›¸åº”çš„åŸŸå
2. **åˆ†é¡µå‚æ•°**: é¡µç ä» 0 å¼€å§‹ï¼Œä¸æ˜¯ä» 1 å¼€å§‹
3. **æœç´¢å…³é”®è¯**: éœ€è¦è¿›è¡Œ URL ç¼–ç 
4. **RSS ç¼“å­˜**: RSS æ¥å£æœ‰ 1 å°æ—¶çš„ç¼“å­˜
5. **é‚®ç®±éªŒè¯**: è®¢é˜…é‚®ç®±éœ€è¦æœ‰æ•ˆçš„é‚®ç®±æ ¼å¼
6. **æ–‡ç« çŠ¶æ€**: å‰å°åªèƒ½è·å–å·²å‘å¸ƒ(PUBLISHED)çŠ¶æ€çš„æ–‡ç« 
7. **æŸ¥è¯¢ç»Ÿè®¡åŠŸèƒ½** ğŸ†•:
   - æŸ¥è¯¢ç»Ÿè®¡åŠŸèƒ½ä¸»è¦ç”¨äºå¼€å‘å’Œè°ƒè¯•é˜¶æ®µ
   - ç”Ÿäº§ç¯å¢ƒå»ºè®®å…³é—­æŸ¥è¯¢ç»Ÿè®¡ä»¥æé«˜æ€§èƒ½
   - æŸ¥è¯¢ç»Ÿè®¡ä¿¡æ¯ä¼šå¢åŠ å“åº”ä½“å¤§å°
   - å¯ä»¥é€šè¿‡ç¯å¢ƒå˜é‡æ§åˆ¶æ˜¯å¦å¯ç”¨æŸ¥è¯¢ç»Ÿè®¡
   - æŸ¥è¯¢ç»Ÿè®¡ç¼“å­˜æœ€å¤šä¿å­˜ 100 ä¸ªæœ€è¿‘çš„è¯·æ±‚

## åœ¨çº¿æ–‡æ¡£

å®Œæ•´çš„ API æ–‡æ¡£å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼æŸ¥çœ‹ï¼š

- **Swagger UI**: http://localhost:8888/api/swagger-ui.html
- **OpenAPI JSON**: http://localhost:8888/api/api-docs

å»ºè®®åœ¨å¼€å‘è¿‡ç¨‹ä¸­ç»“åˆ Swagger UI è¿›è¡Œæ¥å£æµ‹è¯•å’Œè°ƒè¯•ã€‚

## æŸ¥è¯¢ç»Ÿè®¡åŠŸèƒ½ä½¿ç”¨åœºæ™¯ ğŸ†•

### å¼€å‘é˜¶æ®µ

- **æ€§èƒ½ä¼˜åŒ–**: è¯†åˆ«æ…¢æŸ¥è¯¢å’Œ N+1 æŸ¥è¯¢é—®é¢˜
- **è°ƒè¯•è¾…åŠ©**: äº†è§£æ¥å£èƒŒåçš„æ•°æ®åº“æ“ä½œ
- **å­¦ä¹ å·¥å…·**: å¸®åŠ©ç†è§£ ORM ç”Ÿæˆçš„ SQL è¯­å¥

### æ¼”ç¤ºå±•ç¤º

- **æŠ€æœ¯å±•ç¤º**: å‘ç”¨æˆ·å±•ç¤ºç³»ç»Ÿçš„é€æ˜åº¦å’ŒæŠ€æœ¯å®åŠ›
- **æ€§èƒ½æŒ‡æ ‡**: å®æ—¶å±•ç¤ºç³»ç»Ÿçš„æŸ¥è¯¢æ€§èƒ½
- **æ•™å­¦ç”¨é€”**: å¸®åŠ©å­¦ä¹ è€…ç†è§£æ•°æ®åº“æŸ¥è¯¢è¿‡ç¨‹

### ç›‘æ§å‘Šè­¦

- **æ€§èƒ½ç›‘æ§**: ç›‘æ§æŸ¥è¯¢æ‰§è¡Œæ—¶é—´å’Œé¢‘ç‡
- **å¼‚å¸¸æ£€æµ‹**: å‘ç°å¼‚å¸¸çš„æŸ¥è¯¢æ¨¡å¼
- **å®¹é‡è§„åˆ’**: äº†è§£æ•°æ®åº“è´Ÿè½½æƒ…å†µ

### å‰ç«¯é›†æˆç¤ºä¾‹

```javascript
// åœ¨å¼€å‘ç¯å¢ƒä¸­è‡ªåŠ¨å¯ç”¨æŸ¥è¯¢ç»Ÿè®¡
const isDevelopment = process.env.NODE_ENV === "development";

// è·å–æ–‡ç« åˆ—è¡¨æ—¶è‡ªåŠ¨åŒ…å«ç»Ÿè®¡ä¿¡æ¯
const { articles, queryStats } = await fetchArticles(0, 10, isDevelopment);

// åœ¨æ§åˆ¶å°è¾“å‡ºæŸ¥è¯¢ç»Ÿè®¡
if (queryStats && isDevelopment) {
  console.group("ğŸ” æ•°æ®åº“æŸ¥è¯¢ç»Ÿè®¡");
  console.log(`æ‰§è¡Œäº† ${queryStats.totalQueries} ä¸ªæŸ¥è¯¢`);
  console.log(`æ€»è€—æ—¶: ${queryStats.totalExecutionTime}ms`);
  console.log(`å¹³å‡è€—æ—¶: ${queryStats.averageExecutionTime}ms`);
  console.log("æŸ¥è¯¢ç±»å‹åˆ†å¸ƒ:", queryStats.queryTypeStats);
  console.log("è¡¨è®¿é—®ç»Ÿè®¡:", queryStats.tableAccessStats);
  console.groupEnd();
}
```
